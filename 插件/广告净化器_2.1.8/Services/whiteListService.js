!function(t,i){t.whiteListService=function(){"use strict";var e={whiteListRule:!0,filterId:i.AntiBannerFiltersId.WHITE_LIST_FILTER_ID},s=function(){var i=t.urlFilter,e=t.userSettings;this.defaultWhiteListMode=e.isDefaultWhiteListMode(),this.whiteListFilter=new i,this.blockListFilter=new i,this.whiteListDomains=[],this.blockListDomains=[]};return s.prototype={WHITE_LIST_DOMAINS_LS_PROP:"white-list-domains",BLOCK_LIST_DOMAINS_LS_PROP:"block-list-domains",initWhiteListFilters:function(){this.whiteListDomains=this._getDomainsFromLS(this.WHITE_LIST_DOMAINS_LS_PROP),this.blockListDomains=this._getDomainsFromLS(this.BLOCK_LIST_DOMAINS_LS_PROP);var t,i;for(t=0;t<this.whiteListDomains.length;t++)i=this._createWhiteListRule(this.whiteListDomains[t]),i&&this.whiteListFilter.addRule(i);for(t=0;t<this.blockListDomains.length;t++)i=this._createWhiteListRule(this.blockListDomains[t]),i&&this.blockListFilter.addRule(i)},findWhiteListRule:function(t){var s=i.StringUtils,h=i.UrlUtils,r=i.RequestTypes;if(s.isEmpty(t))return null;var o=h.getHost(t);if(this.defaultWhiteListMode)return this.whiteListFilter.isFiltered(t,o,r.DOCUMENT,!1);var l=this.blockListFilter.isFiltered(t,o,r.DOCUMENT,!1);return l?null:e},isDefaultMode:function(){return this.defaultWhiteListMode},changeDefaultWhiteListMode:function(i){var e=t.userSettings;this.defaultWhiteListMode=i,e.changeDefaultWhiteListMode(i)},getWhiteList:function(){return this.defaultWhiteListMode?this.whiteListDomains:this.blockListDomains},whiteListUrl:function(t){var e=i.UrlUtils,s=e.getHost(t);this.defaultWhiteListMode?this.addToWhiteList(s):this.removeFromWhiteList(s)},unWhiteListUrl:function(t){var e=i.UrlUtils,s=e.getHost(t);this.defaultWhiteListMode?this.removeFromWhiteList(s):this.addToWhiteList(s)},addToWhiteList:function(t){var i=this._createWhiteListRule(t);i&&(this.defaultWhiteListMode?this.whiteListFilter.addRule(i):this.blockListFilter.addRule(i),this._addToArray(t),this._saveToLS())},addToWhiteListArray:function(t){if(t){for(var i=[],e=0;e<t.length;e++){var s=t[e],h=this._createWhiteListRule(s);h&&(i.push(h),this.defaultWhiteListMode?this.whiteListFilter.addRule(h):this.blockListFilter.addRule(h),this._addToArray(s))}this._saveToLS()}},removeFromWhiteList:function(t){var i=this._createWhiteListRule(t);i&&(this.defaultWhiteListMode?this.whiteListFilter.removeRule(i):this.blockListFilter.removeRule(i)),this._removeFromArray(t),this._saveToLS()},clearWhiteList:function(){var i=t.urlFilter;this.defaultWhiteListMode?(this.whiteListDomains=[],this.whiteListFilter=new i):(this.blockListDomains=[],this.blockListFilter=new i),this._saveToLS()},getRules:function(){return this.whiteListFilter.getRules()},_createWhiteListRule:function(e){var s=i.StringUtils,h=t.FilterRuleBuilder,r=i.AntiBannerFiltersId;return s.isEmpty(e)?null:h.createRule("@@//"+e+"$document",r.WHITE_LIST_FILTER_ID)},_addToArray:function(t){t&&(this.defaultWhiteListMode&&this.whiteListDomains.indexOf(t)<0?this.whiteListDomains.push(t):this.blockListDomains.indexOf(t)<0&&this.blockListDomains.push(t))},_removeFromArray:function(t){var e=i.CollectionUtils;t&&(this.defaultWhiteListMode?e.removeAll(this.whiteListDomains,t):e.removeAll(this.blockListDomains,t))},_saveToLS:function(){var t=i.LocalStorage;t.setItem(this.WHITE_LIST_DOMAINS_LS_PROP,JSON.stringify(this.whiteListDomains)),t.setItem(this.BLOCK_LIST_DOMAINS_LS_PROP,JSON.stringify(this.blockListDomains))},_getDomainsFromLS:function(t){var e=i.LocalStorage,s=[];try{var h=e.getItem(t);h&&(s=JSON.parse(h))}catch(t){}return s}},new s}()}(yiclearAPI,vAPI);