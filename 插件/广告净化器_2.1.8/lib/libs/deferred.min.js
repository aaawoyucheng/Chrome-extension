!function(){var n,e,r,t,o,i,u,l,c,f,s,p,a,h,y=[].slice;o="3.0.0",e="pending",t="resolved",r="rejected",c=function(n,e){return null!=n?n.hasOwnProperty(e):void 0},s=function(n){return c(n,"length")&&c(n,"callee")},p=function(n){return c(n,"promise")&&"function"==typeof(null!=n?n.promise:void 0)},l=function(n){return s(n)?l(Array.prototype.slice.call(n)):Array.isArray(n)?n.reduce(function(n,e){return Array.isArray(e)?n.concat(l(e)):(n.push(e),n)},[]):[n]},i=function(n,e){return 0>=n?e():function(){return--n<1?e.apply(this,arguments):void 0}},a=function(n,e){return function(){var r;return r=[n].concat(Array.prototype.slice.call(arguments,0)),e.apply(this,r)}},u=function(n,e,r){var t,o,i,u,c;for(u=l(n),c=[],o=0,i=u.length;i>o;o++)t=u[o],c.push(t.call.apply(t,[r].concat(y.call(e))));return c},n=function(){var o,i,c,f,s,a,h;return h=e,f=[],s=[],a=[],c={resolved:{},rejected:{},pending:{}},this.promise=function(o){var i,d;return o=o||{},o.state=function(){return h},d=function(n,r,t){return function(){return h===e&&r.push.apply(r,l(arguments)),n()&&u(arguments,c[t]),o}},o.done=d(function(){return h===t},f,t),o.fail=d(function(){return h===r},s,r),o.progress=d(function(){return h!==e},a,e),o.always=function(){var n;return(n=o.done.apply(o,arguments)).fail.apply(n,arguments)},i=function(e,r,t){var i,u;return u=new n,i=function(n,e,r){return r?o[n](function(){var n,t;return n=1<=arguments.length?y.call(arguments,0):[],t=r.apply(null,n),p(t)?t.done(u.resolve).fail(u.reject).progress(u.notify):u[e](t)}):o[n](u[e])},i("done","resolve",e),i("fail","reject",r),i("progress","notify",t),u},o.pipe=i,o.then=i,null==o.promise&&(o.promise=function(){return o}),o},this.promise(this),o=this,i=function(n,r,t){return function(){return h===e?(h=n,c[n]=arguments,u(r,c[n],t),o):this}},this.resolve=i(t,f),this.reject=i(r,s),this.notify=i(e,a),this.resolveWith=function(n,e){return i(t,f,n).apply(null,e)},this.rejectWith=function(n,e){return i(r,s,n).apply(null,e)},this.notifyWith=function(n,r){return i(e,a,n).apply(null,r)},this},h=function(){var e,r,t,o,u,c,f;if(r=l(arguments),1===r.length)return p(r[0])?r[0]:(new n).resolve(r[0]).promise();if(u=new n,!r.length)return u.resolve().promise();for(o=[],t=i(r.length,function(){return u.resolve.apply(u,o)}),r.forEach(function(n,e){return p(n)?n.done(function(){var n;return n=1<=arguments.length?y.call(arguments,0):[],o[e]=n.length>1?n:n[0],t()}):(o[e]=n,t())}),c=0,f=r.length;f>c;c++)e=r[c],p(e)&&e.fail(u.reject);return u.promise()},f=function(e){return e.Deferred=function(){return new n},e.ajax=a(e.ajax,function(e,r){var t,o,i,u;return null==r&&(r={}),o=new n,t=function(n,e){return a(n,function(){var n,r;return r=arguments[0],n=2<=arguments.length?y.call(arguments,1):[],r&&r.apply(null,n),e.apply(null,n)})},r.success=t(r.success,o.resolve),r.error=t(r.error,o.reject),u=e(r),i=o.promise(),i.abort=function(){return u.abort()},i}),e.when=h},"undefined"!=typeof exports?(exports.Deferred=function(){return new n},exports.when=h,exports.installInto=f):"function"==typeof define&&define.amd?define(function(){return"undefined"!=typeof Zepto?f(Zepto):(n.when=h,n.installInto=f,n)}):"undefined"!=typeof Zepto?f(Zepto):(this.Deferred=function(){return new n},this.Deferred.when=h,this.Deferred.installInto=f)}.call(this);